# yaml-language-server: $schema=https://api.cerbos.dev/latest/cerbos/policy/v1/Policy.schema.json
---
apiVersion: api.cerbos.dev/v1
description: Demo MCP Server
resourcePolicy:
  resource: mcp_tool
  version: default
  importDerivedRoles:
    - common
  rules:
    - actions:
        - cmd::list_resources
        - cmd::list_prompts
        - cmd::list_tools
        - list::greet
        - call::greet
        - list::get_sales_data
        - call::get_sales_data
        - list::get_engineering_data
        - call::get_engineering_data
        - list::admin_tool
        - call::admin_tool
      roles:
        - ADMIN
      effect: EFFECT_ALLOW
    - actions:
        - list::greet
        - call::greet
        - cmd::list_tools
        - list::get_hr_records
        - call::get_hr_records
      roles:
        - HR
      effect: EFFECT_ALLOW
    - actions:
        - list::greet
        - call::greet
        - cmd::list_prompts
        - cmd::list_tools
        - list::get_sales_data
      roles:
        - SALES
      effect: EFFECT_ALLOW
    - actions:
        - call::get_sales_data
      derivedRoles:
        - SALES_EMEA
      effect: EFFECT_ALLOW
      condition:
        match:
          expr: R.attr.arguments.region=="EMEA"
  schemas:
    principalSchema:
      ref: cerbos:///principal.json
    resourceSchema:
      ref: cerbos:///resources/mcp_tool.json
  constants:
    local:
      meta::availableActions:
        - list::greet
        - call::greet
        - cmd::list_resources
        - cmd::list_prompts
        - cmd::list_tools
        - list::get_sales_data
        - call::get_sales_data
        - list::get_engineering_data
        - call::get_engineering_data
        - list::get_hr_records
        - call::get_hr_records
        - list::admin_tool
        - call::admin_tool
